{"remainingRequest":"/Users/chole/Public/text/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chole/Public/text/src/App.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/Users/chole/Public/text/src/App.vue","mtime":1600160582966},{"path":"/Users/chole/Public/text/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chole/Public/text/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/chole/Public/text/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/chole/Public/text/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chole/Public/text/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chole/Public/text/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCkBpbXBvcnQgJ2Jvb3RzdHJhcC9zY3NzL2Jvb3RzdHJhcCc7CiNtYXAgewogIGhlaWdodDogMTAwdmg7Cn0KLmhvbWUgewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKfQouaGlnaGxpZ2h0IHsKICBiYWNrZ3JvdW5kOiAjZTlmZmUzOwp9Ci50b29sYm94IHsKICBoZWlnaHQ6IDEwMHZoOwogIG92ZXJmbG93LXk6IGF1dG87CiAgYSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgfQp9Cg=="},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div class=\"home row no-gutters\">\n    <div class=\"col-sm-3\">\n      <div v-if=\"cityName.length\" class=\"toolbox\">\n        <div class=\"sticky-top bg-white shadow-sm p-2\">\n          <div class=\"form-group d-flex\">\n            <label for=\"cityName\" class=\"mr-2 col-form-label text-right\">縣市</label>\n            <div class=\"flex-fill\">\n              <select id=\"cityName\" class=\"form-control\"\n              v-model=\"select.city\" @change=\"select.area = ''\">\n                <option value=\"\">-- 選擇縣市 --</option>\n                <option :value=\"c.CityName\" v-for=\"c in cityName\" :key=\"c.CityName\">\n                  {{ c.CityName }}\n                </option>\n              </select>\n            </div>\n          </div>\n          <div class=\"form-group d-flex\">\n            <label for=\"area\" class=\"mr-2 col-form-label text-right\">地區</label>\n            <div class=\"flex-fill\">\n              <select id=\"area\" class=\"form-control\" v-if=\"select.city.length\"\n                v-model=\"select.area\" @change=\"updateSelect\">\n                <option value=\"\">-- 選擇地區 --</option>\n                <option :value=\"a.AreaName\"\n                  v-for=\"a in cityName.find((city) => city.CityName === select.city).AreaList\"\n                  :key=\"a.AreaName\">\n                  {{ a.AreaName }}\n                </option>\n              </select>\n            </div>\n          </div>\n          <p class=\"mb-0 small text-muted text-right\">請先選擇區域查看（綠色表示還有口罩）</p>\n        </div>\n\n        <ul class=\"list-group\">\n          <template v-for=\"(item, key) in data\">\n            <a class=\"list-group-item text-left\" :key=\"key\"\n              v-if=\"item.properties.county === select.city\n                && item.properties.town === select.area\"\n              :class=\"{ 'highlight': item.properties.mask_adult || item.properties.mask_child}\"\n              @click=\"penTo(item)\">\n              <h3>{{ item.properties.name }}</h3>\n              <p class=\"mb-0\">\n                成人口罩：{{ item.properties.mask_adult}} | 兒童口罩：{{ item.properties.mask_child}}\n              </p>\n              <p class=\"mb-0\">地址：<a :href=\"`https://www.google.com.tw/maps/place/${item.properties.address}`\"\n                target=\"_blank\" title=\"Google Map\">\n                {{ item.properties.address }}</a>\n              </p>\n            </a>\n          </template>\n        </ul>\n      </div>\n    </div>\n    <div class=\"col-sm-9\">\n      <div id=\"map\"></div>\n    </div>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport L from 'leaflet';\nimport cityName from './assets/cityName.json';\nlet osmMap = {};\nconst iconsConfig = {\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [1, -34],\n  shadowSize: [41, 41],\n};\nconst icons = {\n  green: new L.Icon({\n    iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png',\n    ...iconsConfig,\n  }),\n  grey: new L.Icon({\n    iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-grey.png',\n    ...iconsConfig,\n  }),\n};\nconst osm = {\n  addMapMarker(x, y, item) {\n    const icon = item.mask_adult || item.mask_child ? icons.green : icons.grey;\n    L.marker([y, x], {\n      icon,\n    }).addTo(osmMap).bindPopup(`<strong>${item.name}</strong> <br>\n    口罩剩餘：<strong>成人 - ${item.mask_adult ? `${item.mask_adult} 個` : '未取得資料'}/ 兒童 - ${item.mask_child ? `${item.mask_child} 個` : '未取得資料'}</strong><br>\n    地址: <a href=\"https://www.google.com.tw/maps/place/${item.address}\" target=\"_blank\">${item.address}</a><br>\n    電話: ${item.phone}<br>\n    <small>最後更新時間: ${item.updated}</small>`);\n  },\n  removeMapMarker() {\n    osmMap.eachLayer((layer) => {\n      if (layer instanceof L.Marker) {\n        osmMap.removeLayer(layer);\n      }\n    });\n  },\n  penTo(x, y, item) {\n    const icon = item.mask_adult || item.mask_child ? icons.green : icons.grey;\n    osmMap.panTo(new L.LatLng(y, x));\n    L.marker([y, x], {\n      icon,\n    }).addTo(osmMap).bindPopup(`<strong>${item.name}</strong> <br>\n    口罩剩餘：<strong>成人 - ${item.mask_adult ? `${item.mask_adult} 個` : '未取得資料'}/ 兒童 - ${item.mask_child ? `${item.mask_child} 個` : '未取得資料'}</strong><br>\n    地址: <a href=\"https://www.google.com.tw/maps/place/${item.address}\" target=\"_blank\">${item.address}</a><br>\n    電話: ${item.phone}<br>\n    <small>最後更新時間: ${item.updated}</small>`).openPopup();\n  },\n};\nexport default {\n  name: 'home',\n  data: () => ({\n    cityName,\n    data: {},\n    osmMap: {},\n    select: {\n      city: '臺北市',\n      area: '大安區',\n    },\n  }),\n  methods: {\n    updateMarker() {\n      const pharmacies = this.data.filter((pharmacy) => {\n        if (!this.select.area) {\n          return pharmacy.properties.county === this.select.city;\n        }\n        return pharmacy.properties.town === this.select.area;\n      });\n      pharmacies.forEach((pharmacy) => {\n        const { properties, geometry } = pharmacy;\n        osm.addMapMarker(\n          geometry.coordinates[0],\n          geometry.coordinates[1],\n          properties,\n        );\n      });\n      this.penTo(pharmacies[0]);\n    },\n    removeMarker() {\n      osm.removeMapMarker();\n    },\n    penTo(pharmacy) {\n      const { properties, geometry } = pharmacy;\n      osm.penTo(geometry.coordinates[0], geometry.coordinates[1], properties);\n    },\n    updateSelect() {\n      this.removeMarker();\n      this.updateMarker();\n      const pharmacy = this.data.find(item => item.properties.town === this.select.area);\n      const { geometry, properties } = pharmacy;\n      osm.penTo(geometry.coordinates[0], geometry.coordinates[1], properties);\n    },\n  },\n  mounted() {\n    // OSM\n    osmMap = L.map('map', {\n      center: [25.03, 121.55],\n      zoom: 15,\n    });\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: '<a target=\"_blank\" href=\"https://www.openstreetmap.org/\">© OpenStreetMap 貢獻者</a>',\n      maxZoom: 18,\n    }).addTo(osmMap);\n    this.$http.get('https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json')\n      .then((res) => {\n        this.data = res.data.features;\n        this.updateMarker();\n      });\n  },\n};\n</script>\n\n<style lang=\"scss\">\n@import 'bootstrap/scss/bootstrap';\n#map {\n  height: 100vh;\n}\n.home {\n  position: relative;\n}\n.highlight {\n  background: #e9ffe3;\n}\n.toolbox {\n  height: 100vh;\n  overflow-y: auto;\n  a {\n    cursor: pointer;\n  }\n}\n</style>"]}]}