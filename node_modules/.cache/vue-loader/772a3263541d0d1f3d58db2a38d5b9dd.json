{"remainingRequest":"/Users/chole/Public/text/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chole/Public/text/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/chole/Public/text/src/App.vue","mtime":1600160582966},{"path":"/Users/chole/Public/text/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chole/Public/text/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/chole/Public/text/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chole/Public/text/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIEAgaXMgYW4gYWxpYXMgdG8gL3NyYwppbXBvcnQgTCBmcm9tICdsZWFmbGV0JzsKaW1wb3J0IGNpdHlOYW1lIGZyb20gJy4vYXNzZXRzL2NpdHlOYW1lLmpzb24nOwpsZXQgb3NtTWFwID0ge307CmNvbnN0IGljb25zQ29uZmlnID0gewogIGljb25TaXplOiBbMjUsIDQxXSwKICBpY29uQW5jaG9yOiBbMTIsIDQxXSwKICBwb3B1cEFuY2hvcjogWzEsIC0zNF0sCiAgc2hhZG93U2l6ZTogWzQxLCA0MV0sCn07CmNvbnN0IGljb25zID0gewogIGdyZWVuOiBuZXcgTC5JY29uKHsKICAgIGljb25Vcmw6ICdodHRwczovL2Nkbi5yYXdnaXQuY29tL3BvaW50aGkvbGVhZmxldC1jb2xvci1tYXJrZXJzL21hc3Rlci9pbWcvbWFya2VyLWljb24tMngtZ3JlZW4ucG5nJywKICAgIC4uLmljb25zQ29uZmlnLAogIH0pLAogIGdyZXk6IG5ldyBMLkljb24oewogICAgaWNvblVybDogJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9wb2ludGhpL2xlYWZsZXQtY29sb3ItbWFya2Vycy9tYXN0ZXIvaW1nL21hcmtlci1pY29uLWdyZXkucG5nJywKICAgIC4uLmljb25zQ29uZmlnLAogIH0pLAp9Owpjb25zdCBvc20gPSB7CiAgYWRkTWFwTWFya2VyKHgsIHksIGl0ZW0pIHsKICAgIGNvbnN0IGljb24gPSBpdGVtLm1hc2tfYWR1bHQgfHwgaXRlbS5tYXNrX2NoaWxkID8gaWNvbnMuZ3JlZW4gOiBpY29ucy5ncmV5OwogICAgTC5tYXJrZXIoW3ksIHhdLCB7CiAgICAgIGljb24sCiAgICB9KS5hZGRUbyhvc21NYXApLmJpbmRQb3B1cChgPHN0cm9uZz4ke2l0ZW0ubmFtZX08L3N0cm9uZz4gPGJyPgogICAg5Y+j572p5Ymp6aSY77yaPHN0cm9uZz7miJDkurogLSAke2l0ZW0ubWFza19hZHVsdCA/IGAke2l0ZW0ubWFza19hZHVsdH0g5YCLYCA6ICfmnKrlj5blvpfos4fmlpknfS8g5YWS56ulIC0gJHtpdGVtLm1hc2tfY2hpbGQgPyBgJHtpdGVtLm1hc2tfY2hpbGR9IOWAi2AgOiAn5pyq5Y+W5b6X6LOH5paZJ308L3N0cm9uZz48YnI+CiAgICDlnLDlnYA6IDxhIGhyZWY9Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20udHcvbWFwcy9wbGFjZS8ke2l0ZW0uYWRkcmVzc30iIHRhcmdldD0iX2JsYW5rIj4ke2l0ZW0uYWRkcmVzc308L2E+PGJyPgogICAg6Zu76KmxOiAke2l0ZW0ucGhvbmV9PGJyPgogICAgPHNtYWxsPuacgOW+jOabtOaWsOaZgumWkzogJHtpdGVtLnVwZGF0ZWR9PC9zbWFsbD5gKTsKICB9LAogIHJlbW92ZU1hcE1hcmtlcigpIHsKICAgIG9zbU1hcC5lYWNoTGF5ZXIoKGxheWVyKSA9PiB7CiAgICAgIGlmIChsYXllciBpbnN0YW5jZW9mIEwuTWFya2VyKSB7CiAgICAgICAgb3NtTWFwLnJlbW92ZUxheWVyKGxheWVyKTsKICAgICAgfQogICAgfSk7CiAgfSwKICBwZW5Ubyh4LCB5LCBpdGVtKSB7CiAgICBjb25zdCBpY29uID0gaXRlbS5tYXNrX2FkdWx0IHx8IGl0ZW0ubWFza19jaGlsZCA/IGljb25zLmdyZWVuIDogaWNvbnMuZ3JleTsKICAgIG9zbU1hcC5wYW5UbyhuZXcgTC5MYXRMbmcoeSwgeCkpOwogICAgTC5tYXJrZXIoW3ksIHhdLCB7CiAgICAgIGljb24sCiAgICB9KS5hZGRUbyhvc21NYXApLmJpbmRQb3B1cChgPHN0cm9uZz4ke2l0ZW0ubmFtZX08L3N0cm9uZz4gPGJyPgogICAg5Y+j572p5Ymp6aSY77yaPHN0cm9uZz7miJDkurogLSAke2l0ZW0ubWFza19hZHVsdCA/IGAke2l0ZW0ubWFza19hZHVsdH0g5YCLYCA6ICfmnKrlj5blvpfos4fmlpknfS8g5YWS56ulIC0gJHtpdGVtLm1hc2tfY2hpbGQgPyBgJHtpdGVtLm1hc2tfY2hpbGR9IOWAi2AgOiAn5pyq5Y+W5b6X6LOH5paZJ308L3N0cm9uZz48YnI+CiAgICDlnLDlnYA6IDxhIGhyZWY9Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20udHcvbWFwcy9wbGFjZS8ke2l0ZW0uYWRkcmVzc30iIHRhcmdldD0iX2JsYW5rIj4ke2l0ZW0uYWRkcmVzc308L2E+PGJyPgogICAg6Zu76KmxOiAke2l0ZW0ucGhvbmV9PGJyPgogICAgPHNtYWxsPuacgOW+jOabtOaWsOaZgumWkzogJHtpdGVtLnVwZGF0ZWR9PC9zbWFsbD5gKS5vcGVuUG9wdXAoKTsKICB9LAp9OwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2hvbWUnLAogIGRhdGE6ICgpID0+ICh7CiAgICBjaXR5TmFtZSwKICAgIGRhdGE6IHt9LAogICAgb3NtTWFwOiB7fSwKICAgIHNlbGVjdDogewogICAgICBjaXR5OiAn6Ie65YyX5biCJywKICAgICAgYXJlYTogJ+Wkp+WuieWNgCcsCiAgICB9LAogIH0pLAogIG1ldGhvZHM6IHsKICAgIHVwZGF0ZU1hcmtlcigpIHsKICAgICAgY29uc3QgcGhhcm1hY2llcyA9IHRoaXMuZGF0YS5maWx0ZXIoKHBoYXJtYWN5KSA9PiB7CiAgICAgICAgaWYgKCF0aGlzLnNlbGVjdC5hcmVhKSB7CiAgICAgICAgICByZXR1cm4gcGhhcm1hY3kucHJvcGVydGllcy5jb3VudHkgPT09IHRoaXMuc2VsZWN0LmNpdHk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBwaGFybWFjeS5wcm9wZXJ0aWVzLnRvd24gPT09IHRoaXMuc2VsZWN0LmFyZWE7CiAgICAgIH0pOwogICAgICBwaGFybWFjaWVzLmZvckVhY2goKHBoYXJtYWN5KSA9PiB7CiAgICAgICAgY29uc3QgeyBwcm9wZXJ0aWVzLCBnZW9tZXRyeSB9ID0gcGhhcm1hY3k7CiAgICAgICAgb3NtLmFkZE1hcE1hcmtlcigKICAgICAgICAgIGdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLAogICAgICAgICAgZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0sCiAgICAgICAgICBwcm9wZXJ0aWVzLAogICAgICAgICk7CiAgICAgIH0pOwogICAgICB0aGlzLnBlblRvKHBoYXJtYWNpZXNbMF0pOwogICAgfSwKICAgIHJlbW92ZU1hcmtlcigpIHsKICAgICAgb3NtLnJlbW92ZU1hcE1hcmtlcigpOwogICAgfSwKICAgIHBlblRvKHBoYXJtYWN5KSB7CiAgICAgIGNvbnN0IHsgcHJvcGVydGllcywgZ2VvbWV0cnkgfSA9IHBoYXJtYWN5OwogICAgICBvc20ucGVuVG8oZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sIGdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdLCBwcm9wZXJ0aWVzKTsKICAgIH0sCiAgICB1cGRhdGVTZWxlY3QoKSB7CiAgICAgIHRoaXMucmVtb3ZlTWFya2VyKCk7CiAgICAgIHRoaXMudXBkYXRlTWFya2VyKCk7CiAgICAgIGNvbnN0IHBoYXJtYWN5ID0gdGhpcy5kYXRhLmZpbmQoaXRlbSA9PiBpdGVtLnByb3BlcnRpZXMudG93biA9PT0gdGhpcy5zZWxlY3QuYXJlYSk7CiAgICAgIGNvbnN0IHsgZ2VvbWV0cnksIHByb3BlcnRpZXMgfSA9IHBoYXJtYWN5OwogICAgICBvc20ucGVuVG8oZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sIGdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdLCBwcm9wZXJ0aWVzKTsKICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogICAgLy8gT1NNCiAgICBvc21NYXAgPSBMLm1hcCgnbWFwJywgewogICAgICBjZW50ZXI6IFsyNS4wMywgMTIxLjU1XSwKICAgICAgem9vbTogMTUsCiAgICB9KTsKICAgIEwudGlsZUxheWVyKCdodHRwczovL3tzfS50aWxlLm9wZW5zdHJlZXRtYXAub3JnL3t6fS97eH0ve3l9LnBuZycsIHsKICAgICAgYXR0cmlidXRpb246ICc8YSB0YXJnZXQ9Il9ibGFuayIgaHJlZj0iaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvIj7CqSBPcGVuU3RyZWV0TWFwIOiyoueNu+iAhTwvYT4nLAogICAgICBtYXhab29tOiAxOCwKICAgIH0pLmFkZFRvKG9zbU1hcCk7CiAgICB0aGlzLiRodHRwLmdldCgnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2tpYW5nL3BoYXJtYWNpZXMvbWFzdGVyL2pzb24vcG9pbnRzLmpzb24nKQogICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgdGhpcy5kYXRhID0gcmVzLmRhdGEuZmVhdHVyZXM7CiAgICAgICAgdGhpcy51cGRhdGVNYXJrZXIoKTsKICAgICAgfSk7CiAgfSwKfTsK"},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div class=\"home row no-gutters\">\n    <div class=\"col-sm-3\">\n      <div v-if=\"cityName.length\" class=\"toolbox\">\n        <div class=\"sticky-top bg-white shadow-sm p-2\">\n          <div class=\"form-group d-flex\">\n            <label for=\"cityName\" class=\"mr-2 col-form-label text-right\">縣市</label>\n            <div class=\"flex-fill\">\n              <select id=\"cityName\" class=\"form-control\"\n              v-model=\"select.city\" @change=\"select.area = ''\">\n                <option value=\"\">-- 選擇縣市 --</option>\n                <option :value=\"c.CityName\" v-for=\"c in cityName\" :key=\"c.CityName\">\n                  {{ c.CityName }}\n                </option>\n              </select>\n            </div>\n          </div>\n          <div class=\"form-group d-flex\">\n            <label for=\"area\" class=\"mr-2 col-form-label text-right\">地區</label>\n            <div class=\"flex-fill\">\n              <select id=\"area\" class=\"form-control\" v-if=\"select.city.length\"\n                v-model=\"select.area\" @change=\"updateSelect\">\n                <option value=\"\">-- 選擇地區 --</option>\n                <option :value=\"a.AreaName\"\n                  v-for=\"a in cityName.find((city) => city.CityName === select.city).AreaList\"\n                  :key=\"a.AreaName\">\n                  {{ a.AreaName }}\n                </option>\n              </select>\n            </div>\n          </div>\n          <p class=\"mb-0 small text-muted text-right\">請先選擇區域查看（綠色表示還有口罩）</p>\n        </div>\n\n        <ul class=\"list-group\">\n          <template v-for=\"(item, key) in data\">\n            <a class=\"list-group-item text-left\" :key=\"key\"\n              v-if=\"item.properties.county === select.city\n                && item.properties.town === select.area\"\n              :class=\"{ 'highlight': item.properties.mask_adult || item.properties.mask_child}\"\n              @click=\"penTo(item)\">\n              <h3>{{ item.properties.name }}</h3>\n              <p class=\"mb-0\">\n                成人口罩：{{ item.properties.mask_adult}} | 兒童口罩：{{ item.properties.mask_child}}\n              </p>\n              <p class=\"mb-0\">地址：<a :href=\"`https://www.google.com.tw/maps/place/${item.properties.address}`\"\n                target=\"_blank\" title=\"Google Map\">\n                {{ item.properties.address }}</a>\n              </p>\n            </a>\n          </template>\n        </ul>\n      </div>\n    </div>\n    <div class=\"col-sm-9\">\n      <div id=\"map\"></div>\n    </div>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport L from 'leaflet';\nimport cityName from './assets/cityName.json';\nlet osmMap = {};\nconst iconsConfig = {\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [1, -34],\n  shadowSize: [41, 41],\n};\nconst icons = {\n  green: new L.Icon({\n    iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png',\n    ...iconsConfig,\n  }),\n  grey: new L.Icon({\n    iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-grey.png',\n    ...iconsConfig,\n  }),\n};\nconst osm = {\n  addMapMarker(x, y, item) {\n    const icon = item.mask_adult || item.mask_child ? icons.green : icons.grey;\n    L.marker([y, x], {\n      icon,\n    }).addTo(osmMap).bindPopup(`<strong>${item.name}</strong> <br>\n    口罩剩餘：<strong>成人 - ${item.mask_adult ? `${item.mask_adult} 個` : '未取得資料'}/ 兒童 - ${item.mask_child ? `${item.mask_child} 個` : '未取得資料'}</strong><br>\n    地址: <a href=\"https://www.google.com.tw/maps/place/${item.address}\" target=\"_blank\">${item.address}</a><br>\n    電話: ${item.phone}<br>\n    <small>最後更新時間: ${item.updated}</small>`);\n  },\n  removeMapMarker() {\n    osmMap.eachLayer((layer) => {\n      if (layer instanceof L.Marker) {\n        osmMap.removeLayer(layer);\n      }\n    });\n  },\n  penTo(x, y, item) {\n    const icon = item.mask_adult || item.mask_child ? icons.green : icons.grey;\n    osmMap.panTo(new L.LatLng(y, x));\n    L.marker([y, x], {\n      icon,\n    }).addTo(osmMap).bindPopup(`<strong>${item.name}</strong> <br>\n    口罩剩餘：<strong>成人 - ${item.mask_adult ? `${item.mask_adult} 個` : '未取得資料'}/ 兒童 - ${item.mask_child ? `${item.mask_child} 個` : '未取得資料'}</strong><br>\n    地址: <a href=\"https://www.google.com.tw/maps/place/${item.address}\" target=\"_blank\">${item.address}</a><br>\n    電話: ${item.phone}<br>\n    <small>最後更新時間: ${item.updated}</small>`).openPopup();\n  },\n};\nexport default {\n  name: 'home',\n  data: () => ({\n    cityName,\n    data: {},\n    osmMap: {},\n    select: {\n      city: '臺北市',\n      area: '大安區',\n    },\n  }),\n  methods: {\n    updateMarker() {\n      const pharmacies = this.data.filter((pharmacy) => {\n        if (!this.select.area) {\n          return pharmacy.properties.county === this.select.city;\n        }\n        return pharmacy.properties.town === this.select.area;\n      });\n      pharmacies.forEach((pharmacy) => {\n        const { properties, geometry } = pharmacy;\n        osm.addMapMarker(\n          geometry.coordinates[0],\n          geometry.coordinates[1],\n          properties,\n        );\n      });\n      this.penTo(pharmacies[0]);\n    },\n    removeMarker() {\n      osm.removeMapMarker();\n    },\n    penTo(pharmacy) {\n      const { properties, geometry } = pharmacy;\n      osm.penTo(geometry.coordinates[0], geometry.coordinates[1], properties);\n    },\n    updateSelect() {\n      this.removeMarker();\n      this.updateMarker();\n      const pharmacy = this.data.find(item => item.properties.town === this.select.area);\n      const { geometry, properties } = pharmacy;\n      osm.penTo(geometry.coordinates[0], geometry.coordinates[1], properties);\n    },\n  },\n  mounted() {\n    // OSM\n    osmMap = L.map('map', {\n      center: [25.03, 121.55],\n      zoom: 15,\n    });\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: '<a target=\"_blank\" href=\"https://www.openstreetmap.org/\">© OpenStreetMap 貢獻者</a>',\n      maxZoom: 18,\n    }).addTo(osmMap);\n    this.$http.get('https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json')\n      .then((res) => {\n        this.data = res.data.features;\n        this.updateMarker();\n      });\n  },\n};\n</script>\n\n<style lang=\"scss\">\n@import 'bootstrap/scss/bootstrap';\n#map {\n  height: 100vh;\n}\n.home {\n  position: relative;\n}\n.highlight {\n  background: #e9ffe3;\n}\n.toolbox {\n  height: 100vh;\n  overflow-y: auto;\n  a {\n    cursor: pointer;\n  }\n}\n</style>"]}]}